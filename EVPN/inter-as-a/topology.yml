module: [ ospf, bgp, vxlan, vlan, vrf, evpn ]

provider: clab
defaults.device: frr

groups:
  _auto_create: True
  site_a:                     # Site A - core, leaf, wan edge
    members: [ ca, la, wa ]
    bgp.as: 65001
  site_b:
    members: [ cb, lb, wb ]   # Site B - core, leaf, wan edge
    bgp.as: 65002
  hosts:
    members: [ ha, hb ]       # Hosts attached to leaf-A and leaf-B
    device: linux

vrfs:
  tenant:
    links: [ wa-wb ]          # Inter-AS VRF link (inter-AS option A)
    evpn.transit_vni: True    # Symmetric IRB in Site-A and Site-B

vlans:
  tenant_a:                   # VLAN in Site A
    vrf: tenant               # ... part of tenant VRF
    links: [ la-ha ]          # ... with HA being part of the VLAN
  tenant_b:                   # VLAN in site B
    vrf: tenant               # ... part of tenant VRF
    links: [ lb-hb ]          # ... with HB being part of the VLAN

links:                        # Intra-site fabrics
- group: site_a               # Site A (core-to-leaf, core-to-WAN edge)
  members: [ ca-la, ca-wa ]
- group: site_b               # Site B (core-to-leaf, core-to-WAN edge)
  members: [ cb-lb, cb-wb ]
